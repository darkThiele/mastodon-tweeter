{"version":3,"sources":["components/Authorization.js","components/Toot.js","components/TootDetail.js","components/Timeline.js","components/App.js","index.js"],"names":["Authorization","state","instance","localStorage","getItem","onFormSubmit","event","preventDefault","_this","props","onInstanceSubmit","_this2","this","react_default","a","createElement","className","onSubmit","type","value","onChange","e","setState","target","React","Component","Toot","text","onTootSubmit","keyDownSubmit","ctrlKey","keyCode","buttonPressSubmit","console","log","onKeyDown","dist","class","onClick","TootDetail","onTootClick","toot","account","alt","src","avatar","display_name","acct","content","replace","Timeline","toot_list","map","parsedToot","JSON","parse","payload","src_components_TootDetail","key","id","App","client","authorize_code","access_token","user_credentials","ws","toots","_callee","SCOPES","REDIRECTURI","BASEURL","response","regenerator_default","wrap","_context","prev","next","concat","axios","post","client_name","redirect_uris","scopes","sent","clear","setItem","stringify","data","window","open","client_id","stop","_callee2","ACCESSTOKEN","_context2","status","headers","_callee3","_context3","qs","code","local_instance","local_client_data","local_authorize_code","local_access_token","client_secret","grant_type","redirect_uri","then","WebSocket","onmessage","message","unshift","slice","close","components_Authorization","components_Toot","components_Timeline","ReactDOM","render","react_router_dom","react_router","components_App","queryString","location","search","document","querySelector"],"mappings":"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","file":"static/js/main.9d230576.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nclass Authorization extends React.Component {\r\n    state = {instance: localStorage.getItem('instance_name')}\r\n\r\n    onFormSubmit = event => {\r\n        event.preventDefault();\r\n        // TODO: Give a input to the parent component\r\n        this.props.onInstanceSubmit(this.state.instance);\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"authorization ui form\">\r\n                <form className=\"ui form\" onSubmit={this.onFormSubmit}>\r\n                    <div className=\"field\">\r\n                        <label>User Instance</label>\r\n                        <input \r\n                            type=\"text\"\r\n                            value={this.state.instance}\r\n                            onChange={(e) => this.setState({instance: e.target.value})}\r\n                        />\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Authorization","import React from 'react';\r\nimport {MobileView} from 'react-device-detect';\r\n\r\nclass Toot extends React.Component {\r\n    state = {text: ''};\r\n\r\n    onFormSubmit = event => {\r\n        // TODO: Give a input to the parent component\r\n        this.props.onTootSubmit(this.state.text);\r\n        this.setState({text: ''})\r\n    }\r\n\r\n    keyDownSubmit = event => {\r\n        if(event.ctrlKey && event.keyCode === 13) {\r\n            this.onFormSubmit();\r\n        }\r\n    }\r\n\r\n    buttonPressSubmit = event => {\r\n        event.preventDefault();\r\n        this.onFormSubmit();\r\n    }\r\n\r\n    render() {\r\n        console.log(this.state.text);\r\n        return(\r\n            <div className=\"toot ui form\">\r\n                <form className=\"ui form\" onSubmit={this.onFormSubmit}>\r\n                    <div className=\"field\">\r\n                        <label>User Toot</label>\r\n                        <textarea \r\n                            value={this.state.text}\r\n                            onChange={(e) => this.setState({text: e.target.value})}\r\n                            onKeyDown={this.keyDownSubmit}\r\n                        />\r\n                    </div>\r\n                    <MobileView >\r\n                        <button class=\"fluid ui button\" onClick={this.buttonPressSubmit}>Submit</button>\r\n                    </MobileView>\r\n                </form>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Toot;","import './TootDetail.css'\r\nimport React from 'react';\r\n\r\nclass TootDetail extends React.Component {\r\n\r\n    onTootClick = (event) => {\r\n        this.props.onTootClick(this.props.toot);\r\n    }\r\n\r\n    render() {\r\n        if (!this.props.toot.account) {\r\n            return (\r\n                <div className=\"toot-detail item\">\r\n                    トゥートが削除されています\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n                <div className={`toot-detail item`} onClick={this.onTootClick}>\r\n                    <img alt=\"icon\" className=\"ui avatar image\" src={this.props.toot.account.avatar} />\r\n                    <div className=\"content\">\r\n                        <div className=\"header\">{this.props.toot.account.display_name} @{this.props.toot.account.acct}</div>\r\n                        <div className=\"description\">{this.props.toot.content.replace(/<\\/?[^>]+>/gi, '')}</div>\r\n                    </div>\r\n                </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default TootDetail;","import React from 'react';\r\nimport TootDetail from './TootDetail';\r\n\r\nconst Timeline = (props) => {\r\n    const toot_list = props.toot_list.map((toot) => {\r\n        const parsedToot = JSON.parse(toot.payload);\r\n        return <TootDetail key={parsedToot.id} toot={parsedToot} onTootClick={props.onTootClick}/>\r\n    });\r\n\r\n    return <div className=\"timeline ui relaxed selection divided list\">{toot_list}</div>\r\n};\r\n\r\nexport default Timeline;","import React from 'react';\r\nimport axios from 'axios';\r\nimport Authorization from './Authorization';\r\nimport Toot from './Toot';\r\nimport Timeline from './Timeline';\r\n\r\nclass App extends React.Component {\r\n    state = {instance: null, client: null, authorize_code: null, access_token: null, user_credentials: null, ws: null, toots:[]}\r\n\r\n    componentDidMount() {\r\n        const authorize_code = this.props.qs.code;\r\n\r\n        if (authorize_code) {\r\n            localStorage.setItem('authorize_code', authorize_code)\r\n        }\r\n\r\n        const local_instance = localStorage.getItem('instance_name');\r\n        let local_client_data = null\r\n        if (local_instance) {\r\n            local_client_data = JSON.parse(localStorage.getItem('client_data'))\r\n        }\r\n        const local_authorize_code = localStorage.getItem('authorize_code');\r\n        const local_access_token = localStorage.getItem('access_token')\r\n\r\n        this.setState({instance: local_instance, client: local_client_data, authorize_code: local_authorize_code, access_token: local_access_token});\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        const REDIRECTURI = 'https://darkthiele.github.io/mastodon-tweeter/';\r\n        const BASEURL = `https://${this.state.instance}`\r\n\r\n        if (this.state.instance && this.state.client && this.state.authorize_code && !this.state.access_token) {\r\n\r\n            const response = axios.post(`${BASEURL}/oauth/token`, {\r\n                client_id: this.state.client.client_id,\r\n                client_secret: this.state.client.client_secret,\r\n                grant_type: 'authorization_code',\r\n                code: this.state.authorize_code,\r\n                redirect_uri: REDIRECTURI\r\n            });\r\n\r\n            response.then( response => localStorage.setItem('access_token', response.data.access_token));\r\n            response.then( response => this.setState({access_token: response.data.access_token}));\r\n        }\r\n\r\n        if (this.state.instance && this.state.client && this.state.authorize_code && this.state.access_token && !this.state.ws) {\r\n        \r\n            const ws = new WebSocket(`wss://${this.state.instance}/api/v1/streaming?access_token=${this.state.access_token}&stream=public:local`);\r\n            ws.onmessage = (event) => {\r\n                const message = JSON.parse(event.data);\r\n                this.state.toots.unshift(message);\r\n                this.setState({toots: this.state.toots.slice(0, 50)});\r\n            };\r\n            this.setState({ws: ws});\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.state.ws.close();\r\n    }\r\n\r\n    onInstanceSubmit = async (instance) => {\r\n        // createOAuthApp\r\n        const CLIENTNAME = 'mastodon-Tweeter';\r\n        const SCOPES = 'read write follow';\r\n        const REDIRECTURI = 'https://darkthiele.github.io/mastodon-tweeter/';\r\n        const BASEURL = `https://${instance}`\r\n\r\n        const response = await axios.post(`${BASEURL}/api/v1/apps`, {\r\n                client_name: CLIENTNAME,\r\n                redirect_uris: REDIRECTURI,\r\n                scopes: SCOPES\r\n        });\r\n\r\n        localStorage.clear()\r\n\r\n        localStorage.setItem('instance_name', instance);\r\n        localStorage.setItem('client_data', JSON.stringify(response.data));\r\n\r\n        this.setState({instance: instance, client: response.data})\r\n        \r\n        window.open(`${BASEURL}/oauth/authorize?scope=${SCOPES}&response_type=code&redirect_uri=${REDIRECTURI}&client_id=${response.data.client_id}`, '_self');\r\n\r\n    }\r\n\r\n    onTootSubmit = async(text) => {\r\n        const BASEURL = `https://${this.state.instance}`;\r\n        const ACCESSTOKEN = this.state.access_token;\r\n\r\n        await axios.post(`${BASEURL}/api/v1/statuses`, {\r\n            status: text,\r\n        },\r\n        {\r\n            headers: {\r\n                Authorization: `Bearer ${ACCESSTOKEN}`,\r\n            }\r\n        });\r\n    }\r\n\r\n    onTootClick = async(toot) => {\r\n        const BASEURL = `https://${this.state.instance}`;\r\n        const ACCESSTOKEN = this.state.access_token;\r\n        await axios.post(`${BASEURL}/api/v1/statuses/${toot.id}/favourite`, {\r\n        },\r\n        {\r\n            headers: {\r\n                Authorization: `Bearer ${ACCESSTOKEN}`,\r\n            }\r\n        });\r\n    }\r\n\r\n    render() {\r\n        if (!this.state.client) {\r\n            return (\r\n                <div className=\"ui container\">\r\n                    <Authorization onInstanceSubmit = {this.onInstanceSubmit}/>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className=\"ui container\">\r\n                <div className=\"ui segment\">\r\n                    <Authorization onInstanceSubmit = {this.onInstanceSubmit}/>\r\n                    <Toot onTootSubmit = {this.onTootSubmit}/>\r\n                </div>\r\n                <div className=\"ui segment\">\r\n                    <Timeline toot_list = {this.state.toots} onTootClick={this.onTootClick}/>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default App;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { BrowserRouter as Router, Route } from \"react-router-dom\";\r\nimport App from './components/App';\r\nimport queryString from 'query-string';\r\n\r\nReactDOM.render(\r\n    <Router>\r\n        <Route render={(props)=>\r\n            <App\r\n                qs={queryString.parse(props.location.search)} \r\n            />\r\n        }/>\r\n    </Router>,\r\n    document.querySelector('#root')\r\n);"],"sourceRoot":""}